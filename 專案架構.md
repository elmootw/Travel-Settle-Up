# 旅遊分帳 - 專案架構

## 📋 專案概述

一個多人旅遊共享記帳應用，使用 React + Firebase 技術棧，支援管理者管理旅遊群組、團員密碼自動生成、實時債務計算和支出管理。應用採用響應式設計，支援手機、平板和桌面設備，主色調為藍色系。

## ✅ 已實現的核心功能

### 👑 管理者功能
- ✅ 建立多次旅遊分帳群組
- ✅ 為旅遊新增團員，自動產生亂數密碼（8位字母數字組合）
- ✅ 查看該旅遊的所有成員和密碼
- ✅ 刪除整次旅遊（包含所有成員和帳務）
- ✅ 管理者帳號：存儲在 `.env.local` 中（不公開）

### 👤 使用者功能
- ✅ 帳號密碼登入
- ✅ 只能查看自己是團員的旅遊
- ✅ 新增支出紀錄
- ✅ 編輯自己新增的支出
- ✅ 刪除自己新增的支出
- ✅ 支出欄位：項目名稱、金額（台幣）、支付人、分帳人

### 💰 記帳功能
- ✅ 新增支出
- ✅ 編輯支出
- ✅ 刪除支出
- ✅ 用 checkbox 多選方式選擇分帳人
- ✅ 記錄支出建立者和建立時間
- ✅ 管理者可編輯/刪除任何支出

### 📊 債務結算
- ✅ 即時計算每位團員的應收/應付金額
- ✅ 結算概況卡片展示（可展開/收合）
- ✅ 一行兩欄的響應式設計
- ✅ 視覺化顏色區分：
  - 🟢 綠色：應收款項
  - 🔴 紅色：應付款項
  - ⚫ 灰色：已結清

### 🔐 認證與授權
- ✅ Firebase Email Authentication（共用帳號）
- ✅ 使用者名稱和密碼登入
- ✅ 管理者和普通使用者權限分離
- ✅ 只能查看自己是團員的旅遊
- ✅ 只有建立者或管理者可以編輯/刪除支出

### 📱 響應式設計 (RWD)
- ✅ **手機版** (< 640px)：
  - 單欄布局
  - 簡化表格（隱藏次要欄位）
  - 優化表單尺寸和按鈕
  - 結算卡片一列兩個使用者

- ✅ **平板版** (640px - 1024px)：
  - 兩欄布局
  - 顯示更多表格欄位
  - 適當的間距和字體大小

- ✅ **桌面版** (> 1024px)：
  - 完整三欄或多欄布局
  - 所有資訊完整顯示
  - 最佳視覺體驗

### 🎨 設計系統
- **主色調**：藍色系
  - 主藍：#0ea5e9 (sky-500)
  - 深藍：#0284c7 (sky-600)
  - 淺藍背景：#f0f9ff (sky-50)

- **輔助色**：
  - 🟢 綠色（應收）：#10b981 (emerald-500)
  - 🔴 紅色（應付）：#ef4444 (red-500)
  - ⚫ 灰色（結清）：#6b7280 (gray-500)

- **字體**：Noto Sans TC（正體中文）

## 🔧 核心技術棧

| 技術 | 版本 | 用途 |
|------|------|------|
| **React** | 18+ | 前端 UI 框架 |
| **Firebase** | Latest | Authentication + Realtime Database |
| **Tailwind CSS** | 3+ | 樣式框架（CDN） |
| **GitHub Pages** | - | 靜態網站託管 |
| **GitHub Actions** | - | CI/CD 自動部署 |

## 📁 專案結構

```
.
├── public
│   ├── favicon.ico
│   ├── index.html
│   └── manifest.json
├── src
│   ├── App.jsx
│   ├── components
│   │   ├── BalanceCard.jsx
│   │   ├── LoginForm.jsx
│   │   └── Navbar.jsx
│   ├── config
│   │   └── firebase.js
│   ├── hooks
│   │   └── useAuth.js
│   ├── pages
│   │   ├── Dashboard.jsx
│   │   └── LoginPage.jsx
│   ├── services
│   │   └── sheetService.js
│   └── styles
│       └── index.css
├── .env.local
├── .gitignore
├── package.json
└── README.md
```

- **public/**：靜態檔案
- **src/**：程式碼
  - **components/**：共用元件
  - **config/**：設定檔
  - **hooks/**：自訂 Hook
  - **pages/**：頁面元件
  - **services/**：與後端互動的服務
  - **styles/**：全域樣式
- **.env.local**：環境變數（本地開發用）
- **.gitignore**：Git 忽略的檔案
- **package.json**：專案設定和相依套件
- **README.md**：專案說明文件

## 🔒 安全性最佳實踐

1. **敏感資訊管理**：
   - 所有 API keys 存在環境變數（不硬寫在代碼）
   - GitHub Secrets 用於 CI/CD
   - `.env.local` 在 .gitignore 中

2. **使用者認證**：
   - Firebase Authentication 處理密碼加密和儲存
   - 不應在前端儲存密碼
   - 登入失敗訊息應為通用訊息，不洩露有效帳號資訊

3. **資料庫安全**：
   - Firebase 規則要求認證（`auth != null`）
   - 未認證用戶無法存取任何資料
   - 所有讀寫操作都需要有效的 auth token

4. **版本控制**：
   - 定期使用 `git filter-repo` 清除敏感資訊洩露
   - 檢查 git 歷史中是否有機敏資訊

## 📱 典型使用者流程

### 首次使用
1. 進入應用 → 看到登入頁面
2. 輸入有效的帳號和密碼
3. 點擊登入，Firebase 驗證
4. 驗證成功後進入儀表板

### 日常操作
- **新增支出**：點擊「新增支出」，填寫支出表單
- **查看結餘**：BalanceCard 顯示各成員間的債務關係
- **結清帳務**：記錄清算交易
- **登出**：點擊登出按鈕結束會話

## 📊 應用特性

1. **多人協作**：多個使用者可以共享同一個記帳紀錄
2. **實時同步**：使用 Firebase Realtime Database 進行即時更新
3. **自動部署**：GitHub Actions 自動構建和部署到 GitHub Pages
4. **離線備份**：支出資料同時存在 localStorage（離線存取）
5. **響應式設計**：使用 Tailwind CSS 支援多設備

## 🔄 Git 相關

### 敏感資訊管理
- 使用 `.gitignore` 排除敏感檔案
- 定期檢查 git 歷史中是否有洩露的機敏資訊
- 如有洩露，使用 `git filter-repo` 清除

### 標準工作流程
```bash
git add .
git commit -m "descriptive message"
git push origin main
```
推送會自動觸發 GitHub Actions 部署

## 📞 維護注意事項

1. **定期更新依賴**：檢查安全漏洞和新版本
2. **監控 Firebase 配額**：確保未超過免費層限制
3. **檢查 GitHub Actions 日誌**：部署失敗時查看詳細錯誤
4. **備份重要資料**：定期導出 Firebase 資料
5. **監控成本**：Firebase 超免費層後會產生費用

